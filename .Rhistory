}
# new_msg append(new_word)
}
shift = 19
new_msg = ""
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
new_word = paste(new_word, letter[match(substr(word, char, char),letters) + shift], sep = "")
}
print(new_word)
# new_msg append(new_word)
}
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
print(letter[match(substr(word, char, char),letters) + shift])
# new_word = paste(new_word, letter[match(substr(word, char, char),letters) + shift], sep = "")
}
print(new_word)
# new_msg append(new_word)
}
word
word = "gzo"
word
substr(word, 1,1)
match(substr(word, 1,1),letters)
match(substr(word, 1,1),letters) + shift
letter[26]
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
print(letters[match(substr(word, char, char),letters) + shift])
# new_word = paste(new_word, letter[match(substr(word, char, char),letters) + shift], sep = "")
}
print(new_word)
# new_msg append(new_word)
}
26%%26
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
print(letters[(match(substr(word, char, char),letters) + shift) %% 26])
# new_word = paste(new_word, letter[match(substr(word, char, char),letters) + shift], sep = "")
}
print(new_word)
# new_msg append(new_word)
}
26%%27
27
shift = 19
new_msg = ""
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter = letters[(match(substr(word, char, char),letters) + shift)]
if (letter > 26){letter = letter %% 26}
# new_word = paste(new_word, letter[match(substr(word, char, char),letters) + shift], sep = "")
}
print(new_word)
# new_msg append(new_word)
}
# chars = paste(char,())
letter = letters[(match(substr(word, char, char),letters) + shift)]
shift = 19
new_msg = ""
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter = (match(substr(word, char, char),letters) + shift)
print(letter)
# if (letter > 26){letter = letter %% 26}
# new_word = paste(new_word, letter[match(substr(word, char, char),letters) + shift], sep = "")
}
print(new_word)
# new_msg append(new_word)
}
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_nums]
new_word = paste(new_word, letter, sep = "")
}
print(new_word)
# new_msg append(new_word)
}
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
print(new_word)
# new_msg append(new_word)
}
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if(is.NA(letter_num)){browser}
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
print(new_word)
# new_msg append(new_word)
}
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if(isNA(letter_num)){browser}
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
print(new_word)
# new_msg append(new_word)
}
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if(is.na(letter_num)){browser}
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
print(new_word)
# new_msg append(new_word)
}
if(is.na(letter_num)){browser}
new_msg = ""
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if(is.na(letter_num)){browser()}
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
print(new_word)
# new_msg append(new_word)
}
letter_num
word
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if(!is.na(letter_num)){
if(letter != 0){
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
}
}
print(new_word)
# new_msg append(new_word)
}
?paste
for (word in s){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if(!is.na(letter_num)){
if(letter != 0){
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
}
}
new_msg = paste(new_msg, new_word, sep = " ")
}
new_msg
#At a given substitution point, evaluate the energy
convert <- function(strings, shift){
new_msg = ""
for (word in strings){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if(!is.na(letter_num)){
if(letter != 0){
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
}
}
new_msg = paste(new_msg, new_word, sep = " ")
}
}
convert(s,1)
return(new_msg)
#At a given substitution point, evaluate the energy
convert <- function(strings, shift){
new_msg = ""
for (word in strings){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if(!is.na(letter_num)){
if(letter != 0){
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
}
}
new_msg = paste(new_msg, new_word, sep = " ")
}
return(new_msg)
}
convert(s,1)
convert(s,2)
convert(s,3)
convert(s,4)
convert(s,5)
convert(s,6)
convert(s,7)
convert(s,7)
convert(s,8)
convert(s,9)
convert(s,10)
convert(s,11)
convert(s,12)
convert(s,13)
convert(s,14)
convert(s,15)
convert(s,16)
convert(s,17)
convert(s,18)
convert(s,19)
convert(s,20)
convert(s,21)
convert(s,22)
convert(s,21)
convert(s,23)
convert(s,24)
convert(s,25)
convert(s,26)
convert(s,1)
convert(s,2)
convert(s,2)
convert(s,3)
convert(s,4)
convert(s,5)
convert(s,6)
max = 0
best_shift = 0
for (shift_x in 1:length(alphabet)){
fx = energy(s,p,shift_x)
print(fx)
if(fx > max){
max = fx
best_shift = shift_x
}
}
convert(s, 1)
convert(s, 7)
convert(s, 12)
26
convert(s, 20)
convert(s, 23)
convert(s, 24)
convert(s, 15)
convert(s, 7)
convert(s, 6)
for (shift_x in 1:length(alphabet)){
fx = energy(s,p,shift_x)
convert(s,shift_x)
if(fx > max){
max = fx
best_shift = shift_x
}
}
ax = 0
best_shift = 0
for (shift_x in 1:length(alphabet)){
fx = energy(s,p,shift_x)
convert(s,shift_x)
if(fx > max){
max = fx
best_shift = shift_x
}
}
convert(s,1)
convert(s,3)
print(shift_x)
for (shift_x in 1:length(alphabet)){
fx = energy(s,p,shift_x)
print(shift_x)
convert(s,shift_x)
if(fx > max){
max = fx
best_shift = shift_x
}
}
for (shift_x in 1:length(alphabet)-1){
fx = energy(s,p,shift_x)
print(shift_x)
convert(s,shift_x)
if(fx > max){
max = fx
best_shift = shift_x
}
}
# print(shift_x)
convert(s,shift_x)
for (shift_x in 1:length(alphabet)-1){
fx = energy(s,p,shift_x)
# print(shift_x)
convert(s,shift_x)
if(fx > max){
max = fx
best_shift = shift_x
}
}
# print(shift_x)
print(convert(s,shift_x))
for (shift_x in 1:length(alphabet)-1){
fx = energy(s,p,shift_x)
# print(shift_x)
print(convert(s,shift_x))
if(fx > max){
max = fx
best_shift = shift_x
}
}
# read coded message
input <- readLines("CodedMessage_Short.txt", n=1000)
input <- readLines("CodedMessage_Med.txt", n=1000)
# read frequency table
p <-read.table("LetterPairFreqFrom7Novels.txt")
input <- tolower(input)
s <- strsplit(input, split = " ")
s <- do.call(paste0, as.data.frame(s))
# p[,1]
#
# for (word in s){
#     for(char in 1:str_length(word)){
#       print(char)
#     }
# }
#At a given substitution point, evaluate the energy
energy <- function(strings, pairWeight, shift){
freqs = 0
alphabet <- letters#[1:26]
wls <- str_length(strings) #word lengths
for (word in strings){
for(char in 1:(str_length(word)-1)){
# if (char < str_length(word)){ #Can't index past the last letter
letter1 = (match(substr(word,char,char),alphabet) + shift) %% 26
letter2 = (match(substr(word,char+1,char+1), alphabet) + shift) %% 26
if(!is.na(letter1) & !is.na(letter2)){
if(letter1 != 0 & letter2 != 0){
freqs = freqs + (pairWeight[letter1,letter2])
# print(freqs)
}
}
# for (line in p){ #Every line of frequencies
#   for (letter in 1:26){ #Every letter frequency
#
#   }
# }
}
# browser()
}
return(freqs)
}
max = 0
best_shift = 0
for (shift_x in 1:length(alphabet)-1){
fx = energy(s,p,shift_x)
# print(shift_x)
print(convert(s,shift_x))
if(fx > max){
max = fx
best_shift = shift_x
}
}
#At a given substitution point, evaluate the energy
convert <- function(strings, shift){
new_msg = ""
for (word in strings){
new_word = ""
for(char in 1:(str_length(word))){
# chars = paste(char,())
letter_num = (match(substr(word, char, char),letters) + shift)
if(!is.na(letter_num)){
if(letter != 0){
if (letter_num > 26){letter_num = letter_num %% 26}
letter = letters[letter_num]
new_word = paste(new_word, letter, sep = "")
}
}
}
new_msg = paste(new_msg, new_word, sep = " ")
}
return(new_msg)
}
best_shift = 0
max = 0
for (shift_x in 1:length(alphabet)-1){
fx = energy(s,p,shift_x)
# print(shift_x)
# print(convert(s,shift_x))
if(fx > max){
max = fx
best_shift = shift_x
}
}
best_shift
for (shift_x in 1:length(alphabet)-1){
fx = energy(s,p,shift_x)
# print(shift_x)
# print(convert(s,shift_x))
if(fx > max){
max = fx
best_shift = shift_x
}
}
max
max = 0
best_shift = 0
for (shift_x in 1:length(alphabet)-1){
fx = energy(s,p,shift_x)
# print(shift_x)
# print(convert(s,shift_x))
if(fx > max){
max = fx
best_shift = shift_x
}
}
max
shift
best_shift
ax = 0
best_shift = 0
for (shift_x in 1:length(alphabet)-1){
fx = energy(s,p,shift_x)
print(fx)
# print(convert(s,shift_x))
if(fx > max){
max = fx
best_shift = shift_x
}
}
best_shift
max = 0
best_shift = 0
for (shift_x in 1:length(alphabet)-1){
fx = energy(s,p,shift_x)
print(shift_x)
print(fx)
# print(convert(s,shift_x))
if(fx > max){
max = fx
best_shift = shift_x
}
}
max = 0
best_shift = 0
for (shift_x in 1:(length(alphabet)-1)){
fx = energy(s,p,shift_x)
print(shift_x)
print(fx)
# print(convert(s,shift_x))
if(fx > max){
max = fx
best_shift = shift_x
}
}
max = 0
best_shift = 0
for (shift_x in 0:(length(alphabet)-1)){
fx = energy(s,p,shift_x)
print(shift_x)
print(fx)
# print(convert(s,shift_x))
if(fx > max){
max = fx
best_shift = shift_x
}
}
convert(s, 15)
convert(s, 14)
convert(s, 16)
